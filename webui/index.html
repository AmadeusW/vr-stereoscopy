<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Stereoscopic VR</title>
    <meta name="description" content="Watch stereoscopic images in your VR headset">
    <script src="lib/aframe.min.js"></script>
    <script src="lib/aframe-stereo-component.min.js"></script>
    <script src="lib/aframe-animation-component.min.js"></script>
    <script src="lib/aframe-mouse-cursor-component.min.js"></script>
    <script src="lib/aframe-listener.js"></script>
  </head>
  <body>
    <a-scene>
        <div style="width:1000px; display: flex; position:absolute; left:100px; top:100px; z-index:9999; flex-direction: column;">
          <div style="background-color:#999">VR Stereoscopy</div>
          <div style="background-color: #f00; height:128px;">Cascadia</div>
          <div style="background-color: #ff0; height:128px;">Japan</div>
          <div style="background-color: #0f0; height:128px;">2016 at Reddit</div>
          <div style="background-color: #0ff; height:128px;">2015 at Reddit</div>
          <div style="background-color: #00f; height:128px;">Insects</div>
          <div style="background-color: #f0f; height:128px;"></div>
        </div>
      <a-assets>
        <a-mixin id="zone-show" begin="mouseenter" easing="ease-out" attribute="opacity" to="0.2" dur="200"></a-mixin>
        <a-mixin id="zone-hide" begin="mouseleave" easing="ease-out" attribute="opacity" to="0.01" dur="500"></a-mixin>
      </a-assets>

      <a-entity id="camera" camera="userHeight: 1.6" stereocam="eye:left;" look-controls mouse-cursor>
        <a-cursor fuse="true" id="cursor" color="yellow" fuseTimeout="700" raycaster="objects: .ui-menu"> <!-- todo: see why FAR nor OBJECTS don't work, and why visible: false objects are caught (category changes) -->
          <a-animation begin="click" easing="ease-bounce" attribute="scale"
             to="1 1 1" dur="200"></a-animation>
          <a-animation begin="mouseleave" easing="ease-out" attribute="scale"
             to="1 1 1" dur="300"></a-animation>
          <a-animation begin="fusing" easing="ease-in" attribute="scale"
             to="0.1 0.1 0.1" dur="700"></a-animation>
        </a-cursor> <!-- TODO: Use cursor only when no controllers found -->

        <!-- Stereo picture -->
        <a-entity id="mainPane" visible="false">
          <a-plane id="leftPlane"  position="0 0 -9" width="9" height="9" src="images/201705/6c9wxa.L.jpg" stereo="eye: right"></a-plane>
          <a-plane id="rightPlane" position="0 0 -9" width="9" height="9" src="images/201705/6c9wxa.R.jpg" stereo="eye: left"></a-plane>
        </a-entity>

      </a-entity>

      <a-entity id="allUi">
        <!-- Navigation in slideshow mode -->
        <a-entity id="scrollPane" position="0 1.7 0">
          <a-plane id="menuBottomZone" class="ui-scroll" position="0 -15 0" rotation="-90 0 0" width="50" height="20" color="#99b" opacity="0.01"
            listener__click="event: click; callback: onShowMenu">
            <a-animation mixin="zone-show"></a-animation>
            <a-animation mixin="zone-hide"></a-animation>
            </a-plane>
          <a-plane id="menuTopZone" class="ui-scroll" position="0 15 0" rotation="90 0 0" width="50" height="20" color="#99b" opacity="0.01"
            listener__click="event: click; callback: onShowMenu">
            <a-animation mixin="zone-show"></a-animation>
            <a-animation mixin="zone-hide"></a-animation>
          </a-plane>
          <a-plane id="scrollRThumbZone" class="ui-scroll" color="#99b" opacity="0.01" 
            position="3.1 0 3" width="10" height="20" rotation="0 -90 0"
            listener__click="event: click; callback: onNavigate; params: r"
            listener__enter="event: mouseenter; callback: onSelect; params: scrollRThumb"
            listener__leave="event: mouseleave; callback: onDeselect; params: scrollRThumb"
            >
            <a-animation mixin="zone-show"></a-animation>
            <a-animation mixin="zone-hide"></a-animation>
          </a-plane>
          <a-entity id="scrollRThumb" position="3 0 0" rotation="0 -90 0">
            <a-animation begin="grow" easing="ease-out" attribute="scale"
              fill="forwards" to="2 2 2" dur="200"></a-animation>
            <a-animation begin="shrink" easing="ease-out" attribute="scale"
              fill="forwards" to="1 1 1" dur="300"></a-animation>
            <a-plane id="srollRFrame" class="ui-menu" width="1.1905" height="1.1905" position="0 0 -0.05" material="transparent: true" src="ui/frame.png"></a-plane>
            <a-plane id="scrollRThumbL" class="ui-scroll" width="1" height="1" src="images/201705/6c9wxa.T.L.jpg" stereo="eye: right"></a-plane>
            <a-plane id="scrollRThumbR" class="ui-scroll" width="1" height="1" src="images/201705/6c9wxa.T.R.jpg" stereo="eye: left"></a-plane>
          </a-entity>
          <a-plane id="scrollLThumbZone" class="ui-scroll" color="#99b" opacity="0.01"
            position="-2.9 0 4" width="10" height="20" rotation="0 90 0"
            listener__click="event: click; callback: onNavigate; params: l"
            listener__enter="event: mouseenter; callback: onSelect; params: scrollLThumb"
            listener__leave="event: mouseleave; callback: onDeselect; params: scrollLThumb"
          >
            <a-animation mixin="zone-show"></a-animation>
            <a-animation mixin="zone-hide"></a-animation>
          </a-plane>
          <a-entity id="scrollLThumb" position="-3 0 0" rotation="0 90 0">
            <a-animation begin="grow" easing="ease-out" attribute="scale"
              fill="forwards" to="2 2 2" dur="200"></a-animation>
            <a-animation begin="shrink" easing="ease-out" attribute="scale"
              fill="forwards" to="1 1 1" dur="300"></a-animation>
            <a-plane id="srollRFrame" class="ui-menu" width="1.1905" height="1.1905" position="0 0 -0.05" material="transparent: true" src="ui/frame.png"></a-plane>
            <a-plane id="scrollLThumbL" class="ui-scroll" width="1" height="1" src="images/201705/6c9wxa.T.L.jpg" stereo="eye: right"></a-plane>
            <a-plane id="scrollLThumbR" class="ui-scroll" width="1" height="1" src="images/201705/6c9wxa.T.R.jpg" stereo="eye: left"></a-plane>
          </a-entity>
        </a-entity>

        <!-- Menu -->
        <a-entity id="menuPane" visible="false" position="0 2 -3">
          <a-text id="imageTitle" position="-3 -3 0" color="white" value="."></a-text>

          <a-animation begin="hide" delay="300"
            attribute="visible" to="false"></a-animation>
          <a-animation begin="hide" dur="300" easing="ease-in"
            attribute="position" from="0 2 -3" to="0 2 -4"></a-animation>
          <a-animation begin="show" delay="0"
            attribute="visible" to="true"></a-animation>
          <a-animation begin="show" dur="300" easing="ease-out"
            attribute="position" from="0 2 -4" to="0 2 -3"></a-animation>

          <a-plane width="20" height="20" position="0 0 -0.5" color="#000" opacity="0.7" id="menuCurtain">
            <a-animation begin="show" dur="300"
              attribute="material.opacity" from="0.0" to="0.7"></a-animation>
            <a-animation begin="hide" dur="300"
              attribute="material.opacity" from="0.7" to="0.0"></a-animation>
          </a-plane>

          <a-text id="menuTitle" position="-0.85 0 0" value="Stereoscopic VR">
          </a-text>

          <a-cylinder id="timerButton" class="ui-menu" position="-2 -2.5 0" rotation="90 0 0" color="#311" scale=".25 .05 .25"
            listener__click="event: click; callback: onToggleTimer;"
          >
            <a-animation begin="mouseleave" easing="ease-out" attribute="scale"
              to=".25 .05 .25" dur="500"></a-animation>
            <a-animation begin="mouseenter" easing="ease-out" attribute="scale"
              to="0.3 0.1 0.3" dur="500"></a-animation>
          </a-cylinder>
          <a-text id="imageTitle" position="-1.5 -2.5 0" align="left" color="white" value="Slideshow"></a-text>

          <a-cylinder id="gazeButton" class="ui-menu" position="-2 -3 0" rotation="90 0 0" color="#cc3" scale=".25 .05 .25"
            listener__click="event: click; callback: onToggleGaze;"
          >
            <a-animation begin="mouseleave" easing="ease-out" attribute="scale"
              to=".25 .05 .25" dur="500"></a-animation>
            <a-animation begin="mouseenter" easing="ease-out" attribute="scale"
              to="0.3 0.1 0.3" dur="500"></a-animation>
          </a-cylinder>
          <a-text id="imageTitle" position="-1.5 -3 0" align="left" color="white" value="Use gaze"></a-text>

          <a-entity id="categoryTemplate" class="ui-menu" visible="false">
            <a-entity class="categoryThumb" class="ui-menu" scale="1 1 1"
              listener__click="event: click; callback: onConfirm; params: -1, -1"
              listener__enter="event: mouseenter; callback: onSelect"
              listener__leave="event: mouseleave; callback: onDeselect"
              >
              <a-plane id="srollRFrame" class="ui-menu" width="1.1905" height="1.1905" position="0 -0.3 -0.05" material="transparent: true" src="ui/frame.png"></a-plane>
              <a-plane class="thumbL" class="ui-menu" position="0 -0.3 0" src="images/201705/6c9wxa.T.L.jpg" stereo="eye: right"></a-plane>
              <a-plane class="thumbR" class="ui-menu" position="0 -0.3 0" src="images/201705/6c9wxa.T.R.jpg" stereo="eye: left"></a-plane>
              <a-animation begin="grow" easing="ease-out" attribute="scale"
                fill="forwards" to="1.2 1.2 1.2" dur="200"></a-animation>
              <a-animation begin="shrink" easing="ease-out" attribute="scale"
                fill="forwards" to="1 1 1" dur="300"></a-animation>
            </a-entity>
            <a-text class="title" position="-0.3 0.4 0" scale="0.5 0.5 0.5" color="white" value="Sample category"></a-text>
          </a-entity>
        </a-entity>
      </a-entity>
        
      <a-sky color="#000"></a-sky>
      <a-light type="ambient"></a-light>
    </a-scene>
  </body>
  <script src="connectivity.js"></script>
  <script src="menu.js"></script>
  <script src="control.js"></script>
</html>
